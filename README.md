# 🎉MMDダークモード化MOD

* mmdをダークモード化するMODです。
* `jd`は`just dark`または`二黒土星(jikoku dosei)`の略です。

## 🚧注意事項

* メインスレッドだけをダークモード化します。
	* 「ファイルのプロパティ」ダイアログなどは対象外です。
* 文字列はD2Dで描画しないので、影のぼかしは実質機能しません。

> [!IMPORTANT]
> * `MMDPlugin`がインストールされていることを前提にしています。

## 🚀インストール

* `plugin`フォルダに以下のファイルを入れてください。
	* `mm_jd` (フォルダ)

## 🔥アンインストール

* `plugin`フォルダから以下のファイルを取り除いてください。
	* `mm_jd` (フォルダ)

## 💡使い方

### 🏷️`ダークモード化の設定`ダイアログを表示する

1. mmdウィンドウのメニューで`MMDPlugin`→`ダークモード化～`→`設定`を選択します。
1. `ダークモード化の設定`ダイアログが表示されます。

### 🏷️設定を初期化する

1. mmdを起動していない状態で`plugin\mm_jd\config\mm_jd.json`を削除します。

## 🔧設定

* `ダークモード化の設定`ダイアログで設定します。
---
* `ダークモード化の設定`
	* `スタイルファイルのパス`✏️現在開いているスタイルファイルのパスが表示されます。
		* `...`ボタンで読み込むスタイルファイルを変更できます。
		* 現在開いているスタイルファイルが編集されると自動的に再読み込みされます。
		* **※ただし、新しい配色が反映されるのは一部(メニュー・スクロールバー・ダイアログなど)だけです。**
	* `Direct2Dを使用`✏️チェックを入れるとDirect2D(DirectWrite)を使用してテキストやグラデーションを描画します。
		* 現時点では`メニュー`・`ボタン`・`スタティックテキスト`だけが対象です。
	* `コモンダイアログを除外`✏️チェックを入れるとコモンダイアログをダークモード化しないようにします。
		* **※一部はmmdを再起動しないと正常に描画されない場合があるので注意してください。**
* `丸みの設定`
	* `角を丸める`✏️チェックを入れると一部のコントロールに`丸み(%)`が適用されて描画されます。
	* `丸み(%)`✏️角の丸みを%単位で指定します。
* `縁の設定`
	* `疑似3Dエッジ`✏️チェックを入れると一部のコントロールの縁が浮かび上がるように描画されます。
	* `縁の幅(1/10)`✏️縁の幅を**0.1px**単位で指定します。
		* ※ただし、実質機能しません。太くすると描画が破綻する場合があります。
* `グラデーションの設定`
	* `グラデーション描画`✏️チェックを入れると一部のコントロールがグラデーション描画されます。
	* `終了色にアルファを適用`✏️チェックを入れるとグラデーション終了色に`終了色アルファ(%)`が適用されます。
	* `終了色アルファ(%)`✏️グラデーション終了色に適用するアルファを指定します。
		* `終了色アルファ`は単一色でグラデーション効果を発生させるために使用されます。
* `影の設定`
	* `影の描画`✏️チェックを入れると一部のコントロールのテキストに影が描画されます。
	* `ぼかし`✏️チェックを入れると影にガウスぼかしが適用されて描画されます。
	* `位置`✏️影の位置を**0.1px**単位で指定します。
	* `サイズ`✏️ぼかしのサイズを**0.1px**単位で指定します。
* `スクロールバーの設定`
	* `矢印をボタンとして描画`✏️チェックを入れるとスクロールバーの矢印をボタンとして描画します。
	* `つまみのグリッパーを描画`✏️チェックを入れるとスクロールバーのつまみにグリッパーを描画します。
	* `太さ(%)`✏️スクロールバーの太さを%単位で指定します。
* `スリムバーの設定`
	* `スリムバーを使用`✏️チェックを入れるとタイトルバーとメニューバーが一体化(スリムバー化)します。
	* `タイトルを全体中央に描画`
		* ✏️チェックを入れるとスリムバーの中央にタイトルが描画されます。
		* ✏️チェックを入れてない場合はスリムバーの空きスペースの中央にタイトルが描画されます。
	* `ボタンの幅(%)`✏️スリムバーのボタンの幅を高さを基準に%単位で指定します。
	* `タイトルの書式`✏️スリムバーのタイトルの書式を指定します。
		* `%title%`は元のタイトル名に置換されます。
* `その他の設定`
	* `コントロールの位置を調整`✏️チェックを入れるとコントロールの位置を微調整します。
		* ※mmdを再起動すると反映されます。
	* `メニュー項目の右側配置を抑制`✏️チェックを入れるとメニュー項目を右側に配置しないようにします。
		* ※mmdを再起動すると反映されます。

## 📝スタイルファイル

1. `plugin\mm_jd\config\style.conf`をテキストエディタで編集します。

## 📝独自スタイルファイル

1. `plugin\mm_jd\config\custom_color.conf`をテキストエディタで編集します。

### 書式

* `UTF-8`の`iniファイル`のようなファイル形式になっています。
* `セクション`✏️主にコントロールまたはそのパーツの名称になっています。
* `キー`✏️主にコントロールのステートの名称になっています。
	* `サフィックス`
		* `Fill`✏️背景の色です。
		* `Edge`✏️縁の色です。
		* `Text`✏️テキストの色です。
		* `TextShadow`✏️テキストの影の色です。
* `色の値`
	* `rrggbb`または`rrggbbaa`形式の16進数で指定します。
	* ※ただし、アルファが使用されるのはDirect2Dで描画する場合だけです。

### 例

* エディットボックスの選択色を赤に変更します。

```ini
[EditBox]
SelectFill=ff0000
```

---

* `疑似3DEdge`をカスタマイズします。
* 縁の左上の色をアルファ0x66の割合で白とブレンドします。
* 縁の右下の色をアルファ0x77の割合で黒とブレンドします。

```ini
[3DEdge]
Raised=ffffff66,00000077
```

---

* 縁の陰影を個別に変更します。
* 縁の左上をアルファ0x40の白に変更します。
* 縁の右下をアルファ0x80の黒に変更します。

```ini
HotEdge=ffffff40,00000080
```

---

* `共通のテキストの影`をカスタマイズします。
* すべてのテキストの影をアルファ0xccの青で描画します。

```ini
[Common]
TextShadow=0000ffcc
```

---

* テキストの影を個別にカスタマイズします。
* テキストの影をアルファ0x80の赤で描画します。
* ただし、ホット状態のボタンだけに適用されます。
* その他の状態は`共通のテキストの影`の設定で描画されます。

```ini
[Button]
HotTextShadow=ff000080
```

## 🔖更新履歴

* 🔖r2 #2025年10月20日
	* 🩹再生開始に時間がかかる問題に対応

* 🔖r1 #2025年10月19日
	* 🎉初版

## ⚗️動作確認

* MikuMikuDance_v932x64 https://www.nicovideo.jp/watch/sm2420025
* MMDPlugin ver0.41 64bit版 https://bowlroll.net/file/121761

## 💳クレジット

* MMDPlugin ver0.41 64bit版 開発者用 https://bowlroll.net/file/135503
* MMDPluginDLL https://github.com/Soul-chan/MMDPluginDLL
* Microsoft Research Detours Package https://github.com/microsoft/Detours
* JSON for Modern C++ https://github.com/nlohmann/json
* illustAC https://www.ac-illust.com/

## 👽️作成者情報
 
* 作成者 - 蛇色 (へびいろ)
* GitHub - https://github.com/hebiiro
* X - https://x.com/io_hebiiro

## 🚨免責事項

この作成物および同梱物を使用したことによって生じたすべての障害・損害・不具合等に関しては、私と私の関係者および私の所属するいかなる団体・組織とも、一切の責任を負いません。各自の責任においてご使用ください。
